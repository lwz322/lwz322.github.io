---
layout: article
title: 注册美区Apple ID
author :
mathjax: true
mermaid: true
chart: true
mathjax_autoNumber: true
lightbox: true
tags: Apple
key: apple_id
mode: immersive
header:
  theme: dark
article_header:
  type: overlay
  theme: dark
  background_color: '#ffffff'
  background_image:
    src: https://cdn.jsdelivr.net/gh/lwz322/pics/github.io/xichong.jpg
    gradient: 'linear-gradient(0deg, rgba(0, 0, 0 , .2), rgba(0, 0, 0, .2))'
---
因为想要下载一个软件体验，所以参考了下网络上的教程尝试了下，有种水到渠成的感觉，这里留个记录，另外就是记录下折腾黑苹果的一段经历

<!--more-->
# 注册Apple ID
主要就是网络环境，之后的所有工作是围绕网络环境来的

网络环境：这里用的是Google Cloud Platform（GCP）的VPS，DigitalOcean的打开注册页面为502（可能是用的人太多了，Do类似的情况很常见）

为了复制粘贴方便用的PC端的浏览器（必要的话开无痕模式），不同的平台流程可能不一样

## 注册过程
- 检查下当前的IP，这里用的[IPIP.net](ipip.net)，页面上的地理位置以及经纬度信息在后面有用
- 打开[Apple ID](https://appleid.apple.com/)，语言是英文的
- 填写邮箱，姓名等与地理位置无关的信息
- 付款方法暂时选的None

### 地理位置
网络上有那种地址身份信息生成器，据说地址，注册IP以及验证的电话在相关的时候比较省事，所以这里就从网络到地址一步步来

首先是根据之前的IP得到的经纬度信息，在Google地图中找到具体的位置，可以得到申请需要的：州，城市，街道，邮编

之后再在经纬度周边找到一个有提供电话信息的位置，后面需要用到其区号
![](https://i.loli.net/2019/12/18/pVASHJWngKyRMGe.png)

### 电话
据说会用短信验证（我并没有走这个流程），这里选择用[TextNow](textnow.com)提供的虚拟电话号码，提供地理位置（区号）就行

## 充值
我手上的双币卡是无法直接做为支付方式的，但是据说可以买官网上的礼品卡，然而面额都有些大，所以就在淘宝上找小面额的礼品卡，这里要注意的是，因为盗刷信用卡情况的比较多，网上不乏有那种特别便宜的软件激活码和充值方式，切记不能贪小便宜（据说重则封号）

## 其他设置
设置密保问题，完善个人信息之类的，之后登陆就可以看到英文的Apple Store，貌似下载软件的速度有点慢

# 黑苹果

之前也是试过好几次，但是搞不清楚的问题实在是太多了，一时半会处理不完
- 之前只有一台电脑，如果翻车会影响日常生活
- 之前能够找到的EFI不多，也没有看到那种特别基础的教程
- 这个学期MacOS 10.15发布，想要体验下新功能
- 某些开发环境在MacOS下配置更加方便
- 忘了在哪里看到的言论：八代处理器的台式机安装黑苹果非常简单
- 最关键的是，我的Win10又开始出现各种小问题，翻车顺带重装

于是假期花点时间尝试一下

## 摘要

这里先要提一下配置情况：
- Asus Z370-I主板搭配的八代UHD630核显的CPU
- 因为10.14起，N卡不再有可以用的驱动，所以这里使用核显输出，用的家里的HDMI线（估计是遇到困难的主要原因）
- 自带无线网卡是RTL8822BE，黑苹果无驱动，暂时不更换，暂用USB连接手机热点上网
- 在windows下制作安装U盘

目前来看最终的效果还是要回到学校，换DP输出和无线网卡，测试一段时间

下面来梳理安装的思路

1. 在远景或者黑果小兵下载10.15.2的镜像
2. 寻找对应主板和系统版本的EFI，主要在：
- tonymacx86，黑苹果首屈一指的论坛
- Github，相对来说readme写的比较清楚
- 远景，大量的说不清楚的资源以及过期的百度云链接，有效信息密度较低但是最贴合实际

3. 将镜像以及替换的EFI写入启动U盘，设置BIOS
4. 无法启动～开始遍历相关资料

后续解决的问题：
- 核显HDMI输出时无法启动
- 找到的EFI无法直接安装或升级10.15.2
- USB3.0无法接入3.0设备
- 电脑传感器无法正常读取数据，风扇无法控制
- 睡眠唤醒问题

## 引导
最主流的应该还是Clover，OpenCore是未来的趋势，但是现在可以找到的即用的资料比较少；在黑果小兵或者远景可以下载到带有Clover的安装镜像，之后使用Etcher写到U盘，再在上面提到的站点搜索EFI做替换就好，然而这里会遇到一些问题：
- 与系统版本和硬件情况完全匹配的EFI较为难找，部分经验贴没有给出具体的系统版本与实际的硬件情况，例如HDMI输出问题
- 10.15系统发布的时间不长，发出来的资源较少
- Clover的具体定制需要用到MacOS平台下的Clover Configurator
- 在与已有资源与实际情况稍有出入时，EFI应该如何替换

所以这里第一步就是要收集EFI，既然10.15的相对难找，我找了10.14.x的EFI，先安装上再说，毕竟有了Clover Configurator配置起来会方便很多，这里又遇到了无法进入安装界面的问题，根据```-v```的启动参数都没查到确切的原因，直到把HDMI接到独显上才成功进入了安装界面

独显自然是无法完美驱动的，显而易见的有顶栏和底栏无法开启透明效果，而且移动鼠标都可以感受到卡顿；于是可以大致锁定是HDMI输出的问题，之后就搜索到了黑苹果需要调整下才能输出HDMI，我自己探知的方法是在Clover Configurator->Device中勾选UseIntelHDMI，之后显示器接主板的HDMI，重启即可（Clover Configurator居然有中文，部分选项还有提示）

## 排查

### 升级
按照网络上的说法，升级10.15.x需要：升级Clover，更新Kext到比较高的版本，然而我并没有这么一帆风顺，然后又找了一些EFI，反复对比和修改了下，最后对黑果小兵的EFI分区的driver和kext做了删减，把10.14的config修改了下放了进去，终于成功安装了10.15.2，因为之前的文件系统是HFS，所以直接重新抹盘安装了
> 推测是Clover以及kext还有driver需要高度适配才行，config可以从外部导入

### USB定制
之前10.14可以正常识别和使用USB 3.0，然而10.15只认2.0了，查了下得知是需要定制USB，按照网络上的教程尝试了下，又没有成功，之后把10.14的```SSDT-UIAC-ALL.aml```直接替换了过来就好了

### 传感器与风扇
风扇的声音和在BIOS界面一样，因为接了一个风扇在主板的水泵接口上，所以在此之前都是全速运转，然后按照查到的结果，安装了Macs Fan Control以及HWmonitor，然而什么都没有，之后发现需要安装VirtualSMC或者FakeSMC的一系列kext才行，貌似前者维护得更好，但是只有后者能用，吸取前面的教训，这次依然从镜像配套的EFI里提取文件

### 其他问题
- 短时间睡眠需要一段时间准备，唤醒绿屏，长时间睡眠之后就关机或者重启了，这个暂时没有找到相关的材料，对比也没有发现是哪里的差别
- 偶尔会顿卡（在播放视频的时候非常频繁），卡住一段时间没有反应，这些问题都只有回到学校再说
- 期间出现过频繁的花屏问题，调整CPU电压到自动就正常了
- 无法通过主板的显示接口同时连接两台显示器，并且在连接BenQ的显示器时出现了黑屏无法唤醒的情况

## 小结
确实是只要硬件OK，找到合适的EFI的情况下，黑苹果安装几乎没有什么难度，我算是走了一套流程，和大部分装黑苹果的人差不多，对Clover这些配置依然是一头雾水，记录也是为了留下一点信息

## 进一步完善

最后还是走到了这一步，按照惯例，回馈下已知的信息

下面做的主要是：
- 加装网卡：DW1820A，驱动蓝牙（支持AirDrop隔空投送）
- 生成序列号，使用iMassage
- 使用iCloud打通设备，主要是支持SideCar

必要的配置信息：i7 8700K UHD630 Asus Z370-I，原装的网卡RTL8822BE在黑苹果下无法驱动，加上我一直觉得瑞昱的网卡不太可靠（尽管这块已经是其比较好的网卡了），最后还是决定换为博通以支持黑苹果

### 加装网卡

Asus Z370-I的网卡插在主板背板边缘，网卡拆开WiFi Go的盒子才看得见，规格为m.2 2230 NGFF E key，盒子有两个可拆卸的天线的接口，网卡必须是2X2的，拆卸网卡具体情况看：[我的 ITX Hackintosh / PC 购买、组装、安装系统心得](https://ladit.me/posts/my-itx-hackintosh-and-pc-buying-build-installation-experience/)

弄清楚规格之后就是选网卡了，主要的网卡可以看[攒了一台 4K 视频剪辑黑苹果](https://icyleaf.com/2019/01/itx-coffee-lake-hackintosh-build-for-4k-video-editing/)中的表格和参考文章

大多数人会选择BCM94360CS2这块免驱的网卡（150+），但是最后我还是相中了DW1820A，一方面是因为规格，再一个就是价格（90+），最重要的是经过查阅资料，这块网卡被研究的差不多了，另外黑果小兵也有相关文章:

[DW1820A(BCM94350ZAE) 的子型号说明和一些研究，19年8月终极更新，看99楼](http://bbs.pcbeta.com/forum.php?mod=viewthread&tid=1817694&page=5#pid49489911)

按照上面的教程就可以把Win10以及MacOS下的驱动都装好了，然而我测试的时候发现，这张网卡在win10下，5G有1%的丢包，主要是上传丢包，这显然是有点难以接受的，但是暂时就这样吧（因为我把之前的8822BE拆坏了一个天线引脚），最后发现是网卡的抗干扰能力不行（信号差）

### 序列号问题

有人称这个为黑苹果洗白，来看下B站的[可以在黑苹果登录AppleID吗？怎么激活iMessage](https://www.bilibili.com/video/av90297726)

在浏览黑苹果相关问题的过程中，发现序列号其实是很重要的东西，这里的序列号还和机型有关，我选的机型是Mac Mini 18，据说这样就可以打开核显加速，序列号不宜频繁更换，会导致Apple ID设置出问题（一个序列号就是账号下的一台设备），进而导致后续的SideCar无法使用

### 多系统下的时间不同步问题
这个问题困扰了我很久，网上能查到的解释和解决办法比较杂乱，具体的表现是Windows关机一段时间后，再开机发现时间停留在上次关机的时间点，以及开机状态下休眠，时间会停止在休眠的时间点；历经多次搜索终于从[RTC综述-RTC的问题表现:电脑时钟不走，或者睡眠唤醒后时钟不走](https://hackintool.vercel.app/%E5%9F%BA%E7%A1%80%E7%AF%87/RTC%E7%9A%84%E9%97%AE%E9%A2%98%E8%A1%A8%E7%8E%B0.html)找到了答案，我从文档中主要获得的信息是:
> Apple公司使用自己定义的Apple RTC，Apple RTC记录的内存范围可能不被我们普通的主板所支持

这让我想起了OS是可以写时间信息到主板的，如果格式不一样确实可能导致Windows无法写入主板上的时间，文档中的解决办法主要是针对OpenCore引导的黑苹果的，我还停留在Clover而且没有动力去折腾了，最终找到的解决办法是启动一次Ubuntu之后再启动Windows就正常了
### SideCar
之前怎么也没想到使用SideCar居然和iCloud有关，最开始我觉得只要有线能用就行，之后换好网卡之后发现SideCar居然还是不能用：出现了连接超时还有只能有线连接的情况（远景上有各种问题的讨论）

最后在苹果的官网[Sidecar的其他要求](https://support.apple.com/zh-cn/HT210380)找到了答案，主要就是要开二重认证，经过一番倒腾之后，终于可以用了，我也这才发现：副屏居然不能触摸！！还需要Apple Pencil？？

不过多一块屏幕还是方便很多，具体MacOS还是不太会用，这就当体验一下吧